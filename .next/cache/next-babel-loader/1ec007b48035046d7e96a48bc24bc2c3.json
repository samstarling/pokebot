{"ast":null,"code":"import { emojiFor, renderType, statusFor } from \"../pokemon\";\nexport default {\n  id: \"query-stats\",\n  triggerPhrase: \"How's my PokÃ©mon?\",\n  respond: async (event, client, prisma) => {\n    const rolls = await prisma.roll.findMany({\n      where: {\n        teamId: event.team,\n        userId: event.user\n      },\n      orderBy: {\n        createdAt: \"desc\"\n      },\n      take: 1,\n      include: {\n        Pokemon: true\n      }\n    });\n\n    if (rolls[0] == null) {\n      await client.chat.postMessage({\n        channel: event.channel,\n        text: `<@${event.user}>: You don't have one!`\n      });\n      return;\n    }\n\n    const roll = rolls[0];\n    await client.chat.postMessage({\n      channel: event.channel,\n      text: `<@${event.user}>: :${emojiFor(roll.Pokemon)}: ${roll.Pokemon.name}`,\n      icon_url: `https://gravel-pokebot.herokuapp.com/oak.png`,\n      username: \"Professor Oak\",\n      blocks: [{\n        type: \"section\",\n        text: {\n          type: \"mrkdwn\",\n          text: statusFor(roll.Pokemon)\n        },\n        fields: [{\n          type: \"mrkdwn\",\n          text: renderType(roll.Pokemon)\n        }, {\n          type: \"mrkdwn\",\n          text: `*HP*: ${roll.Pokemon.hp}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Attack*: ${roll.Pokemon.attack}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Defense*: ${roll.Pokemon.defense}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Speed*: ${roll.Pokemon.speed}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Sp. Attack*: ${roll.Pokemon.specialAttack}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Sp. Defense*: ${roll.Pokemon.specialDefense}`\n        }],\n        accessory: {\n          type: \"image\",\n          image_url: `https://pokeres.bastionbot.org/images/pokemon/${roll.Pokemon.number}.png`,\n          alt_text: roll.Pokemon.name\n        }\n      }]\n    });\n  }\n};","map":null,"metadata":{},"sourceType":"module"}