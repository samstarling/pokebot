{"ast":null,"code":"import { emojiFor, imageFor, renderType, statusFor } from \"../pokemon\";\nexport default {\n  id: \"query-stats\",\n  triggerPhrase: \"How's my PokÃ©mon?\",\n  respond: async ({\n    event,\n    client,\n    rollRepo\n  }) => {\n    const rolls = await rollRepo.find({\n      where: {\n        teamId: event.team,\n        userId: event.user\n      },\n      order: {\n        createdAt: \"DESC\"\n      },\n      take: 1,\n      relations: [\"pokemon\"]\n    });\n\n    if (rolls[0] == null) {\n      await client.chat.postMessage({\n        channel: event.channel,\n        text: `<@${event.user}>: You don't have one!`\n      });\n      return;\n    }\n\n    const roll = rolls[0];\n    await client.chat.postMessage({\n      channel: event.channel,\n      text: `<@${event.user}>: :${emojiFor(roll.pokemon)}: ${roll.pokemon.name}`,\n      icon_url: `https://gravel-pokebot.herokuapp.com/oak.png`,\n      username: \"Professor Oak\",\n      blocks: [{\n        type: \"section\",\n        text: {\n          type: \"mrkdwn\",\n          text: statusFor(roll.pokemon)\n        },\n        fields: [{\n          type: \"mrkdwn\",\n          text: renderType(roll.pokemon)\n        }, {\n          type: \"mrkdwn\",\n          text: `*HP*: ${roll.pokemon.hp}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Attack*: ${roll.pokemon.attack}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Defense*: ${roll.pokemon.defense}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Speed*: ${roll.pokemon.speed}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Sp. Attack*: ${roll.pokemon.specialAttack}`\n        }, {\n          type: \"mrkdwn\",\n          text: `*Sp. Defense*: ${roll.pokemon.specialDefense}`\n        }],\n        accessory: {\n          type: \"image\",\n          image_url: imageFor(roll.pokemon),\n          alt_text: roll.pokemon.name\n        }\n      }]\n    });\n  }\n};","map":null,"metadata":{},"sourceType":"module"}