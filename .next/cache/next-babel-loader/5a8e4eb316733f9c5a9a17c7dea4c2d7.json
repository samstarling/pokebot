{"ast":null,"code":"import { PrismaClient } from \"@prisma/client\";\nconst prisma = new PrismaClient();\nimport csv from \"csv-parser\";\nimport fs from \"fs\";\nexport default ((req, res) => {\n  const results = [];\n  fs.createReadStream(\"./data/pokemon.csv\").pipe(csv()).on(\"data\", data => results.push(data)).on(\"end\", () => {\n    results.forEach(async row => {\n      const x = await prisma.pokemon.upsert({\n        where: {\n          number: parseInt(row.pokedex_number)\n        },\n        create: {\n          name: row.name,\n          generation: parseInt(row.generation),\n          number: parseInt(row.pokedex_number)\n        },\n        update: {\n          name: row.name,\n          generation: parseInt(row.generation),\n          number: parseInt(row.pokedex_number)\n        }\n      });\n      console.log(x);\n    });\n    res.status(200).json({\n      results: results\n    });\n  });\n});","map":{"version":3,"sources":["/Users/samstarling/Development/personal/pokebot/pages/api/import.ts"],"names":["PrismaClient","prisma","csv","fs","req","res","results","createReadStream","pipe","on","data","push","forEach","row","x","pokemon","upsert","where","number","parseInt","pokedex_number","create","name","generation","update","console","log","status","json"],"mappings":"AAAA,SAASA,YAAT,QAA6B,gBAA7B;AAEA,MAAMC,MAAM,GAAG,IAAID,YAAJ,EAAf;AAEA,OAAOE,GAAP,MAAgB,YAAhB;AACA,OAAOC,EAAP,MAAe,IAAf;AAIA,gBAAe,CAACC,GAAD,EAAsBC,GAAtB,KAA+C;AAC5D,QAAMC,OAIJ,GAAG,EAJL;AAMAH,EAAAA,EAAE,CAACI,gBAAH,CAAoB,oBAApB,EACGC,IADH,CACQN,GAAG,EADX,EAEGO,EAFH,CAEM,MAFN,EAEeC,IAAD,IAAUJ,OAAO,CAACK,IAAR,CAAaD,IAAb,CAFxB,EAGGD,EAHH,CAGM,KAHN,EAGa,MAAM;AACfH,IAAAA,OAAO,CAACM,OAAR,CAAgB,MAAOC,GAAP,IAAe;AAC7B,YAAMC,CAAC,GAAG,MAAMb,MAAM,CAACc,OAAP,CAAeC,MAAf,CAAsB;AACpCC,QAAAA,KAAK,EAAE;AAAEC,UAAAA,MAAM,EAAEC,QAAQ,CAACN,GAAG,CAACO,cAAL;AAAlB,SAD6B;AAEpCC,QAAAA,MAAM,EAAE;AACNC,UAAAA,IAAI,EAAET,GAAG,CAACS,IADJ;AAENC,UAAAA,UAAU,EAAEJ,QAAQ,CAACN,GAAG,CAACU,UAAL,CAFd;AAGNL,UAAAA,MAAM,EAAEC,QAAQ,CAACN,GAAG,CAACO,cAAL;AAHV,SAF4B;AAOpCI,QAAAA,MAAM,EAAE;AACNF,UAAAA,IAAI,EAAET,GAAG,CAACS,IADJ;AAENC,UAAAA,UAAU,EAAEJ,QAAQ,CAACN,GAAG,CAACU,UAAL,CAFd;AAGNL,UAAAA,MAAM,EAAEC,QAAQ,CAACN,GAAG,CAACO,cAAL;AAHV;AAP4B,OAAtB,CAAhB;AAcAK,MAAAA,OAAO,CAACC,GAAR,CAAYZ,CAAZ;AACD,KAhBD;AAkBAT,IAAAA,GAAG,CAACsB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEtB,MAAAA,OAAO,EAAEA;AAAX,KAArB;AACD,GAvBH;AAwBD,CA/BD","sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst prisma = new PrismaClient();\n\nimport csv from \"csv-parser\";\nimport fs from \"fs\";\n\nimport type { NextApiRequest, NextApiResponse } from \"next\";\n\nexport default (req: NextApiRequest, res: NextApiResponse) => {\n  const results: Array<{\n    name: string;\n    pokedex_number: string;\n    generation: string;\n  }> = [];\n\n  fs.createReadStream(\"./data/pokemon.csv\")\n    .pipe(csv())\n    .on(\"data\", (data) => results.push(data))\n    .on(\"end\", () => {\n      results.forEach(async (row) => {\n        const x = await prisma.pokemon.upsert({\n          where: { number: parseInt(row.pokedex_number) },\n          create: {\n            name: row.name,\n            generation: parseInt(row.generation),\n            number: parseInt(row.pokedex_number),\n          },\n          update: {\n            name: row.name,\n            generation: parseInt(row.generation),\n            number: parseInt(row.pokedex_number),\n          },\n        });\n\n        console.log(x);\n      });\n\n      res.status(200).json({ results: results });\n    });\n};\n"]},"metadata":{},"sourceType":"module"}